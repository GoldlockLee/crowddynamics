

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>crowddynamics.core.motion package &mdash; crowddynamics legacy+297.gd2a5250.dirty documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="crowddynamics legacy+297.gd2a5250.dirty documentation" href="../index.html"/>
        <link rel="up" title="crowddynamics.core package" href="crowddynamics.core.html"/>
        <link rel="next" title="crowddynamics.core.motion.tests package" href="crowddynamics.core.motion.tests.html"/>
        <link rel="prev" title="crowddynamics.core.interactions.tests package" href="crowddynamics.core.interactions.tests.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> crowddynamics
          

          
            
            <img src="../_static/logo.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                legacy+297legacy+297.gd2a5250.dirtygd2a5250
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Multi-Agent Simulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../multiagent.html">Multi-Agent Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactions.html">Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../motion.html">Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steering.html">Steering</a></li>
</ul>
<p class="caption"><span class="caption-text">Api</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="crowddynamics.html">crowddynamics package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="crowddynamics.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="crowddynamics.core.html">crowddynamics.core package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="crowddynamics.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="crowddynamics.core.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="crowddynamics.core.html#module-crowddynamics.core.conftest">crowddynamics.core.conftest module</a></li>
<li class="toctree-l4"><a class="reference internal" href="crowddynamics.core.html#module-crowddynamics.core.evacuation">crowddynamics.core.evacuation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="crowddynamics.core.html#module-crowddynamics.core.geometry">crowddynamics.core.geometry module</a></li>
<li class="toctree-l4"><a class="reference internal" href="crowddynamics.core.html#module-crowddynamics.core.integrator">crowddynamics.core.integrator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="crowddynamics.core.html#module-crowddynamics.core.tree">crowddynamics.core.tree module</a></li>
<li class="toctree-l4"><a class="reference internal" href="crowddynamics.core.html#module-crowddynamics.core.vector2D">crowddynamics.core.vector2D module</a></li>
<li class="toctree-l4"><a class="reference internal" href="crowddynamics.core.html#module-crowddynamics.core">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="crowddynamics.simulation.html">crowddynamics.simulation package</a></li>
<li class="toctree-l3"><a class="reference internal" href="crowddynamics.tests.html">crowddynamics.tests package</a></li>
<li class="toctree-l3"><a class="reference internal" href="crowddynamics.visualization.html">crowddynamics.visualization package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.html#module-crowddynamics.cli">crowddynamics.cli module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.html#module-crowddynamics.config">crowddynamics.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.html#module-crowddynamics.exceptions">crowddynamics.exceptions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.html#module-crowddynamics.io">crowddynamics.io module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.html#module-crowddynamics.logging">crowddynamics.logging module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.html#module-crowddynamics.parse">crowddynamics.parse module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.html#module-crowddynamics.testing">crowddynamics.testing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.html#module-crowddynamics">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidocs_examples/examples.html">examples package</a></li>
</ul>
<p class="caption"><span class="caption-text">Research</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quantities.html">Quantities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phenomena.html">Phenomena</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">crowddynamics</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="crowddynamics.html">crowddynamics package</a> &raquo;</li>
        
          <li><a href="crowddynamics.core.html">crowddynamics.core package</a> &raquo;</li>
        
      <li>crowddynamics.core.motion package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/apidocs/crowddynamics.core.motion.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="crowddynamics-core-motion-package">
<h1>crowddynamics.core.motion package<a class="headerlink" href="#crowddynamics-core-motion-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="crowddynamics.core.motion.tests.html">crowddynamics.core.motion.tests package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.core.motion.tests.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.core.motion.tests.html#module-crowddynamics.core.motion.tests.test_motion">crowddynamics.core.motion.tests.test_motion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.core.motion.tests.html#module-crowddynamics.core.motion.tests.test_power_law">crowddynamics.core.motion.tests.test_power_law module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.core.motion.tests.html#module-crowddynamics.core.motion.tests.test_power_law_benchmark">crowddynamics.core.motion.tests.test_power_law_benchmark module</a></li>
<li class="toctree-l2"><a class="reference internal" href="crowddynamics.core.motion.tests.html#module-crowddynamics.core.motion.tests">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-crowddynamics.core.motion.adjusting">
<span id="crowddynamics-core-motion-adjusting-module"></span><h2>crowddynamics.core.motion.adjusting module<a class="headerlink" href="#module-crowddynamics.core.motion.adjusting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="adjusting">
<h3>Adjusting<a class="headerlink" href="#adjusting" title="Permalink to this headline">¶</a></h3>
<p>Adjusting motion account for agents desire to move and rotate towards their
desired goal.</p>
<dl class="attribute">
<dt id="crowddynamics.core.motion.adjusting.force_adjust">
<code class="descclassname">crowddynamics.core.motion.adjusting.</code><code class="descname">force_adjust</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/adjusting.html#force_adjust"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.adjusting.force_adjust" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Adjusting</em> aka <em>driving</em> force accounts of agent&#8217;s desire to reach a
certain destination. In high crowd densities term <em>manoeuvring</em> is used.
Force affecting the agent takes form</p>
<div class="math">
\[\mathbf{f}_{adj} = \frac{m}{\tau_{adj}} (v_{0} \mathbf{\hat{e}_{0}} - \mathbf{v}),\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mass</strong> (<em>float</em>) &#8211; Mass <span class="math">\(m\)</span></li>
<li><strong>tau_adj</strong> (<em>float</em>) &#8211; Characteristic time <span class="math">\(\tau_{adj}\)</span> time for agent to adjust it
movement. Value <span class="math">\(0.5\)</span> is often used, but for example impatient
agent that tend to push other agent more this value can be reduced.</li>
<li><strong>v0</strong> (<em>float</em>) &#8211; Target velocity <span class="math">\(v_{0}\)</span> is usually <em>average walking speed</em> for
agent in its current situation.</li>
<li><strong>e0</strong> (<em>numpy.ndarray</em>) &#8211; Target direction <span class="math">\(\mathbf{\hat{e}_{0}}\)</span> is solved by
<em>navigation</em> or <em>path planning</em> algorithm. More details in the
navigation section.</li>
<li><strong>v</strong> (<em>numpy.ndarray</em>) &#8211; Velocity <span class="math">\(\mathbf{v}\)</span></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Adjusting force vector <span class="math">\(\mathbf{f}_{adj}\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="crowddynamics.core.motion.adjusting.force_adjust_agents">
<code class="descclassname">crowddynamics.core.motion.adjusting.</code><code class="descname">force_adjust_agents</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/adjusting.html#force_adjust_agents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.adjusting.force_adjust_agents" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply adjusting force to agents</p>
</dd></dl>

<dl class="attribute">
<dt id="crowddynamics.core.motion.adjusting.torque_adjust">
<code class="descclassname">crowddynamics.core.motion.adjusting.</code><code class="descname">torque_adjust</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/adjusting.html#torque_adjust"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.adjusting.torque_adjust" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjusting torque accounts for agent&#8217;s desire to rotate it orientation.</p>
<div class="math">
\[M_{adj} = \frac{I_{rot}}{\tau_{rot}} \left( \omega_{0} \left (
          \frac{\varphi - \varphi_{0}}{\pi} \right ) - \omega\right),\]</div>
<p>Angular difference <span class="math">\(\varphi - \varphi_{0}\)</span> is wrapped between interval
<span class="math">\([-\pi, \pi]\)</span> so that division by <span class="math">\(\pi\)</span> returns value between
<span class="math">\([-1, 1]\)</span>. This gives direction and magnitude for the torque.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inertia_rot</strong> (<em>float</em>) &#8211; Rotational inertia <span class="math">\(I_{rot}\)</span></li>
<li><strong>tau_rot</strong> (<em>float</em>) &#8211; Characteristic time <span class="math">\(\tau_{rot}\)</span> time for agent to adjust it
orientation.</li>
<li><strong>phi_0</strong> (<em>float</em>) &#8211; Target orientation <span class="math">\(\varphi_{0}\)</span>. In low and medium crowd
densities the angle of the target direction can be sufficient for
target orientation. In high crowd densities agents may twist their
body differently for example to try to squeeze through narrow
spaces, requiring more sophisticated algorithms.</li>
<li><strong>phi</strong> (<em>float</em>) &#8211; Current orientation <span class="math">\(\varphi\)</span></li>
<li><strong>omega_0</strong> (<em>float</em>) &#8211; Maximum angular velocity <span class="math">\(\omega_{0}\)</span>.</li>
<li><strong>omega</strong> (<em>float</em>) &#8211; Angular velocity <span class="math">\(\omega\)</span></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Adjusting torque scalar <span class="math">\(M_{adj}\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="crowddynamics.core.motion.adjusting.torque_adjust_agents">
<code class="descclassname">crowddynamics.core.motion.adjusting.</code><code class="descname">torque_adjust_agents</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/adjusting.html#torque_adjust_agents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.adjusting.torque_adjust_agents" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply adjusting torque to agents</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-crowddynamics.core.motion.contact">
<span id="crowddynamics-core-motion-contact-module"></span><h2>crowddynamics.core.motion.contact module<a class="headerlink" href="#module-crowddynamics.core.motion.contact" title="Permalink to this headline">¶</a></h2>
<div class="section" id="contact">
<h3>Contact<a class="headerlink" href="#contact" title="Permalink to this headline">¶</a></h3>
<p>Physical contact with other objects.</p>
<dl class="attribute">
<dt id="crowddynamics.core.motion.contact.force_contact">
<code class="descclassname">crowddynamics.core.motion.contact.</code><code class="descname">force_contact</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/contact.html#force_contact"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.contact.force_contact" title="Permalink to this definition">¶</a></dt>
<dd><p>Physical contact force with damping. Helbing&#8217;s original model did not
include damping, which was added by Langston.</p>
<div class="math">
\[\mathbf{f}^{c}(h) = - h \cdot \left(\mu \cdot \hat{\mathbf{n}} -
\kappa \cdot (\mathbf{v} \cdot \hat{\mathbf{t}}) \hat{\mathbf{t}}\right) +
c \cdot (\mathbf{v} \cdot \hat{\mathbf{n}}) \hat{\mathbf{n}}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>h</strong> (<em>float</em>) &#8211; Skin-to-skin distance <span class="math">\(h\)</span> between agents</li>
<li><strong>n</strong> (<em>numpy.ndarray</em>) &#8211; Normal vector <span class="math">\(\mathbf{\hat{n}}\)</span></li>
<li><strong>v</strong> (<em>numpy.ndarray</em>) &#8211; Velocity vector <span class="math">\(\mathbf{v}\)</span></li>
<li><strong>t</strong> (<em>numpy.ndarray</em>) &#8211; Tangent vector <span class="math">\(\mathbf{\hat{t}}\)</span></li>
<li><strong>mu</strong> (<em>float</em>) &#8211; Constant <span class="math">\(\mu = 1.2 \cdot 10^{5}\,\mathrm{kg\,s^{-2}}\)</span></li>
<li><strong>kappa</strong> (<em>float</em>) &#8211; Constant <span class="math">\(\kappa = 4.0 \cdot 10^{4}\,\mathrm{kg\,m^{-1}s^{-1}}\)</span></li>
<li><strong>damping</strong> (<em>float</em>) &#8211; Constant <span class="math">\(c = 500 \,\mathrm{N}\)</span></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Contact force vector</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-crowddynamics.core.motion.fluctuation">
<span id="crowddynamics-core-motion-fluctuation-module"></span><h2>crowddynamics.core.motion.fluctuation module<a class="headerlink" href="#module-crowddynamics.core.motion.fluctuation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fluctuation">
<h3>Fluctuation<a class="headerlink" href="#fluctuation" title="Permalink to this headline">¶</a></h3>
<p>Fluctuation force and torque are stochastic in nature and analogous to heat in
particle systems. For modeling fluctuation we use <span class="math">\(\mathcal{U}(a, b)\)</span> for
continuous uniform distribution and <span class="math">\(\mathcal{N}(\mu, \sigma^{2})\)</span> for
truncated normal distribution.</p>
<dl class="function">
<dt id="crowddynamics.core.motion.fluctuation.force_fluctuation">
<code class="descclassname">crowddynamics.core.motion.fluctuation.</code><code class="descname">force_fluctuation</code><span class="sig-paren">(</span><em>mass</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/crowddynamics/core/motion/fluctuation.html#force_fluctuation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.fluctuation.force_fluctuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncated normal distribution with standard deviation of 3.</p>
<div class="math">
\[\boldsymbol{\xi} = \xi \cdot \mathbf{\hat{e}}(\varphi)\]</div>
<p>where</p>
<ul class="simple">
<li><span class="math">\(\xi \sim \mathcal{N}(\mu, \sigma^{2})\)</span></li>
<li><span class="math">\(\varphi \sim \mathcal{U}(-\pi, \pi)\)</span></li>
<li><span class="math">\(\mathbf{\hat{e}}(\varphi)\)</span> is unit vector to direction of
<span class="math">\(\varphi\)</span>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mass</strong> (<em>numpy.ndarray</em>) &#8211; Mass</li>
<li><strong>scale</strong> (<em>numpy.ndarray</em>) &#8211; Standard deviation of truncated normal distribution</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Fluctuation force vector</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="crowddynamics.core.motion.fluctuation.torque_fluctuation">
<code class="descclassname">crowddynamics.core.motion.fluctuation.</code><code class="descname">torque_fluctuation</code><span class="sig-paren">(</span><em>inertia_rot</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/crowddynamics/core/motion/fluctuation.html#torque_fluctuation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.fluctuation.torque_fluctuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Random torque</p>
<div class="math">
\[\eta \sim \mathcal{N}(\mu, \sigma^{2})\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inertia_rot</strong> (<em>numpy.ndarray</em>) &#8211; Rotational intertial</li>
<li><strong>scale</strong> (<em>numpy.ndarray</em>) &#8211; Standard deviation of truncated normal distribution</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Fluctuation torque scalar</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-crowddynamics.core.motion.helbing">
<span id="crowddynamics-core-motion-helbing-module"></span><h2>crowddynamics.core.motion.helbing module<a class="headerlink" href="#module-crowddynamics.core.motion.helbing" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="crowddynamics.core.motion.helbing.force_social_helbing">
<code class="descclassname">crowddynamics.core.motion.helbing.</code><code class="descname">force_social_helbing</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/helbing.html#force_social_helbing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.helbing.force_social_helbing" title="Permalink to this definition">¶</a></dt>
<dd><p>Helbing&#8217;s model&#8217;s original social force. Independent of the velocity or
direction of the agent. <a class="reference internal" href="../references.html#helbing2000a" id="id1">[Helbing2000a]</a></p>
<div class="math">
\[A \exp\left(-\frac{h}{B}\right) \mathbf{\hat{n}}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>h</strong> (<em>float</em>) &#8211; Skin-to-skin distance between agents</li>
<li><strong>n</strong> (<em>numpy.ndarray</em>) &#8211; Normal unit vector</li>
<li><strong>a</strong> (<em>float</em>) &#8211; Constant <span class="math">\(A = 2 \cdot 10^{3} \,\mathrm{N}\)</span></li>
<li><strong>b</strong> (<em>float</em>) &#8211; Constant <span class="math">\(B = 0.08 \,\mathrm{m}\)</span></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Social force vector</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-crowddynamics.core.motion.power_law">
<span id="crowddynamics-core-motion-power-law-module"></span><h2>crowddynamics.core.motion.power_law module<a class="headerlink" href="#module-crowddynamics.core.motion.power_law" title="Permalink to this headline">¶</a></h2>
<div class="section" id="universal-power-law-governing-pedestrian-interactions">
<h3>Universal Power Law Governing Pedestrian Interactions<a class="headerlink" href="#universal-power-law-governing-pedestrian-interactions" title="Permalink to this headline">¶</a></h3>
<p>Anticipatory collision avoidance algorithm introduced in <em>Universal power law
governing pedestrian interactions</em> <a class="reference internal" href="../references.html#karamouzas2014b" id="id2">[Karamouzas2014b]</a>. Algorithm is derived from
real world data from the behaviour movement of people in crowds.</p>
<p>Force affecting agent can be derived by taking spatial gradient of the energy,
where time-to-collision <span class="math">\(\tau\)</span> is function of the relative displacement
of the mass centers <span class="math">\(\tilde{\mathbf{x}} = \mathbf{x}_i - \mathbf{x}_j\)</span></p>
<div class="math">
\[\begin{split}\mathbf{f}^{soc} &amp;= -\nabla_{\tilde{\mathbf{x}}} E(\tau) \\
&amp;= - k \cdot m \left(\frac{1}{\tau^{2}}\right) \left(\frac{2}{\tau} +
\frac{1}{\tau_{0}}\right) \exp\left (-\frac{\tau}{\tau_{0}}\right )
\nabla_{\tilde{\mathbf{x}}} \tau\end{split}\]</div>
<p>If <span class="math">\(\tau &lt; 0\)</span> or <span class="math">\(\tau\)</span> is undefined trajectories are not
colliding and social force is <span class="math">\(\mathbf{0}\)</span>.</p>
<div class="figure">
<p><img src="../_images/tikz-53c38f7c881188793f873b381aea286f2a66fdfd.png" alt="\draw[color=gray!20] (0, 0) grid (12, 8);
% Agent i
\coordinate (c1) at (2, 2);
\draw[] (c1) circle (1pt) node[below] {$ \mathbf{x}_i $};
\draw[] (c1) circle (1);
\draw[dashed, color=gray!80] (c1) -- ++(60:7);
\draw[thick, -&gt;] (c1) -- node[right] {$ \mathbf{v}_i $} ++(60:1.5);
% Agent j
\coordinate (c2) at (10, 4);
\draw[] (c2) circle (1pt) node[below] {$ \mathbf{x}_i $};
\draw[] (c2) circle (1);
\draw[dashed, color=gray!80] (c2) -- ++(155:8);
\draw[thick, -&gt;] (c2) -- node[left] {$ \mathbf{v}_i $} ++(155:1.5);
% Distance
\draw[color=gray!60, dashed] (c1) -- node[below] {$h$} (c2);
\draw[thick, -&gt;] (c1) -- node[below] {$r_i$} ++(14:1);
\draw[thick, -&gt;] (c2) -- node[below] {$r_j$} ++(194:1);" /></p>
</div><dl class="attribute">
<dt id="crowddynamics.core.motion.power_law.force_social_circular">
<code class="descclassname">crowddynamics.core.motion.power_law.</code><code class="descname">force_social_circular</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/power_law.html#force_social_circular"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.power_law.force_social_circular" title="Permalink to this definition">¶</a></dt>
<dd><p>Social force based on human anticipatory behaviour.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>agent</strong> (<em>numpy.ndarray</em>) &#8211; </li>
<li><strong>i</strong> (<em>int</em>) &#8211; </li>
<li><strong>j</strong> (<em>int</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(numpy.ndarray, numpy.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="crowddynamics.core.motion.power_law.force_social_three_circle">
<code class="descclassname">crowddynamics.core.motion.power_law.</code><code class="descname">force_social_three_circle</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/power_law.html#force_social_three_circle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.power_law.force_social_three_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>Social force based on human anticipatory behaviour.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>agent</strong> (<em>numpy.ndarray</em>) &#8211; </li>
<li><strong>i</strong> (<em>int</em>) &#8211; </li>
<li><strong>j</strong> (<em>int</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(numpy.ndarray, numpy.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="crowddynamics.core.motion.power_law.gradient_circle_circle">
<code class="descclassname">crowddynamics.core.motion.power_law.</code><code class="descname">gradient_circle_circle</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/power_law.html#gradient_circle_circle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.power_law.gradient_circle_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient of <span class="math">\(\tau\)</span> between two circles.</p>
<div class="math">
\[\nabla_{\tilde{\mathbf{x}}} \tau\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x_rel</strong> (<em>numpy.ndarray</em>) &#8211; Relative position of the centers of mass.
<span class="math">\(\tilde{x} = x_i - x_j\)</span></li>
<li><strong>v_rel</strong> (<em>numpy.ndarray</em>) &#8211; Relative velocity between two agents.
<span class="math">\(\tilde{v} = v_i - v_j\)</span></li>
<li><strong>a</strong> (<em>float</em>) &#8211; </li>
<li><strong>b</strong> (<em>float</em>) &#8211; </li>
<li><strong>d</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="crowddynamics.core.motion.power_law.gradient_three_circle">
<code class="descclassname">crowddynamics.core.motion.power_law.</code><code class="descname">gradient_three_circle</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/power_law.html#gradient_three_circle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.power_law.gradient_three_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient of <span class="math">\(\tau\)</span> between two three-circle representations.</p>
<div class="math">
\[\nabla_{\tilde{\mathbf{x}}} \tau\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x_rel</strong> (<em>numpy.ndarray</em>) &#8211; </li>
<li><strong>v_rel</strong> (<em>numpy.ndarray</em>) &#8211; </li>
<li><strong>r_off</strong> (<em>numpy.ndarray</em>) &#8211; </li>
<li><strong>a</strong> (<em>float</em>) &#8211; </li>
<li><strong>b</strong> (<em>float</em>) &#8211; </li>
<li><strong>d</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="crowddynamics.core.motion.power_law.magnitude">
<code class="descclassname">crowddynamics.core.motion.power_law.</code><code class="descname">magnitude</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/power_law.html#magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.power_law.magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Magnitude of social force.</p>
<div class="math">
\[\left(\frac{1}{\tau^{2}}\right) \left(\frac{2}{\tau} + \frac{1}{\tau_{0}}\right) \exp\left (-\frac{\tau}{\tau_{0}}\right )\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tau</strong> (<em>float</em>) &#8211; Time-to-collision <span class="math">\(\tau &gt; 0\)</span> is obtained by linearly extrapolating
current trajectories and finding where or if agents collide i.e
skin-to-skin distance <span class="math">\(h\)</span> equals zero.</li>
<li><strong>tau_0</strong> (<em>float</em>) &#8211; Interaction time horizon <span class="math">\(\tau_{0} &gt; 0\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Magnitude</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="crowddynamics.core.motion.power_law.potential">
<code class="descclassname">crowddynamics.core.motion.power_law.</code><code class="descname">potential</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/power_law.html#potential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.power_law.potential" title="Permalink to this definition">¶</a></dt>
<dd><p>Psychological force based on human anticipatory behaviour. Interaction potential
between two agents is defined</p>
<div class="math">
\[E(\tau) = m \frac{k}{\tau^{2}} \exp \left( -\frac{\tau}{\tau_{0}} \right)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (<em>float</em>) &#8211; Scaling parameter for the magnitude. Reference value of
<span class="math">\(k=1.5\)</span>.</li>
<li><strong>tau</strong> (<em>float</em>) &#8211; Time-to-collision <span class="math">\(\tau &gt; 0\)</span> is obtained by linearly extrapolating
current trajectories and finding where or if agents collide i.e
skin-to-skin distance <span class="math">\(h\)</span> equals zero.</li>
<li><strong>tau_0</strong> (<em>float</em>) &#8211; Interaction time horizon <span class="math">\(\tau_{0} &gt; 0\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Interaction potential</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="crowddynamics.core.motion.power_law.time_to_collision_circle_circle">
<code class="descclassname">crowddynamics.core.motion.power_law.</code><code class="descname">time_to_collision_circle_circle</code><a class="reference internal" href="../_modules/crowddynamics/core/motion/power_law.html#time_to_collision_circle_circle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.power_law.time_to_collision_circle_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>Time-to-collision of two circles. From <em>skin-to-skin</em> distance</p>
<div class="math">
\[h(\tau) = \| \tau \tilde{\mathbf{v}} + \mathbf{c} \| - \tilde{r}.\]</div>
<p>Solve for root</p>
<div class="math">
\[\begin{split}h(\tau) &amp;= 0 \\
\| \mathbf{c} + \tau \tilde{\mathbf{v}} \| &amp;= \tilde{r} \\
\| \mathbf{c} + \tau \tilde{\mathbf{v}} \|^2 &amp;= \tilde{r}^2\end{split}\]</div>
<p>Quadratic equation is obtained</p>
<div class="math">
\[\tau^2 (\tilde{\mathbf{v}} \cdot \tilde{\mathbf{v}}) + 2 \tau (\mathbf{c} \cdot \tilde{\mathbf{v}}) + \mathbf{c} \cdot \mathbf{c} - \tilde{r}^2 =0\]</div>
<p>Solution with quadratic formula gives us</p>
<div class="math">
\[\begin{split}a &amp;= \tilde{\mathbf{v}} \cdot \tilde{\mathbf{v}} \\
b &amp;= -\mathbf{c} \cdot \tilde{\mathbf{v}} \\
c &amp;= \mathbf{c} \cdot \mathbf{c} - \tilde{r}^{2}\\
d &amp;= \sqrt{b^{2} - a c} \\
\tau &amp;= \frac{b - d}{a}.\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x_rel</strong> (<em>numpy.ndarray</em>) &#8211; Relative center of mass <span class="math">\(\mathbf{c}\)</span>.</li>
<li><strong>v_rel</strong> (<em>numpy.ndarray</em>) &#8211; Relative velocity <span class="math">\(\mathbf{\tilde{v}}\)</span>.</li>
<li><strong>r_tot</strong> (<em>float</em>) &#8211; Total radius of <span class="math">\(\tilde{r} = \mathrm{constant}\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float, numpy.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-crowddynamics.core.motion.subgroups">
<span id="crowddynamics-core-motion-subgroups-module"></span><h2>crowddynamics.core.motion.subgroups module<a class="headerlink" href="#module-crowddynamics.core.motion.subgroups" title="Permalink to this headline">¶</a></h2>
<p>Crowds in real life often have a number of smaller subgroups. Such as group of
two or three friends walking together or couple with or without children.
Model by Langston for subgroups at most 4 people.</p>
<dl class="function">
<dt id="crowddynamics.core.motion.subgroups.adjusting_force_intra_subgroup">
<code class="descclassname">crowddynamics.core.motion.subgroups.</code><code class="descname">adjusting_force_intra_subgroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/crowddynamics/core/motion/subgroups.html#adjusting_force_intra_subgroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.subgroups.adjusting_force_intra_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Intra-subgroup adjusting force.</p>
<p>Subgroup adjusting force adds additional term to adjusting force in social force model</p>
<div class="math">
\[\mathbf{f}^{adj} = \frac{m}{\tau^{adj}} (v_{0} \hat{\mathbf{e}}  + \underset{\text{new}}{\underbrace{k \mathbf{e}_{att}}} - \mathbf{v})\]</div>
<ul class="simple">
<li><span class="math">\(\mathbf{e}_{att} = \mathbf{x}_{att} - \mathbf{x}_{i}\)</span> relative displacement from the formation attractor point</li>
<li><span class="math">\(k\)</span> subgroup velocity constant</li>
</ul>
<p>Returns:</p>
</dd></dl>

<dl class="function">
<dt id="crowddynamics.core.motion.subgroups.attractor_point">
<code class="descclassname">crowddynamics.core.motion.subgroups.</code><code class="descname">attractor_point</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/crowddynamics/core/motion/subgroups.html#attractor_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#crowddynamics.core.motion.subgroups.attractor_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Attractor point</p>
<div class="math">
\[\mathbf{x}_{att} = \mathbf{x}_{n} \pm d \hat{\mathbf{e}} (\theta)\]</div>
<p>where</p>
<ul class="simple">
<li><span class="math">\(\mathbf{x}_{n}\)</span> is the coordinates of relative neighbor</li>
<li><span class="math">\(d\)</span> is desired distance between two consecutive members</li>
<li><span class="math">\(\theta\)</span> is desired angular orientation of the subgroup</li>
</ul>
<p>Returns:</p>
</dd></dl>

</div>
<div class="section" id="module-crowddynamics.core.motion">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-crowddynamics.core.motion" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="crowddynamics.core.motion.tests.html" class="btn btn-neutral float-right" title="crowddynamics.core.motion.tests package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="crowddynamics.core.interactions.tests.html" class="btn btn-neutral" title="crowddynamics.core.interactions.tests package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Jaan Tollander de Balsch.
      Last updated on 2017-05-10.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'legacy+297.gd2a5250.dirty',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
\section{Motion}
\subsection{Social force}
Total force exerted on the agent is the sum of movement adjusting, social and contact forces between other agents and wall.
\begin{align}
\mathbf{f}_{i}(t) = \mathbf{f}_{i}^{adj} + \sum_{j\neq i}^{} \left(\mathbf{f}_{ij}^{soc} + \mathbf{f}_{ij}^{c}\right) + \sum_{w}^{} \left(\mathbf{f}_{iw}^{soc} + \mathbf{f}_{iw}^{c}\right) + \boldsymbol{\xi}_{i}
\end{align}


\subsubsection{Adjusting force}
Force adjusting agent's movement towards desired in some characteristic time \begin{align}
\mathbf{f}^{adj} &= \frac{m}{\tau^{adj}} (v_{0} \cdot \hat{\mathbf{e}} - \mathbf{v}) 
\end{align}


\subsubsection{Social force}
Psychological force for collision avoidance. Naive velocity independent algorithm
\begin{align}
\mathbf{f}^{soc} &= A \exp\left(-\frac{h}{B}\right) \hat{\mathbf{n}}
\end{align}
and improved velocity dependent algorithm
\begin{align}
\mathbf{f}^{soc} &= -\nabla_{\tilde{\mathbf{x}}} E(\tau)  \\
&= -\nabla_{\tilde{\mathbf{x}}} \left(\frac{k}{\tau^{2}} \exp \left( -\frac{\tau}{\tau_{0}} \right) \right) \\
\\
&= - \left(\frac{k}{a \tau^{2}}\right) 
\left(\frac{2}{\tau} + \frac{1}{\tau_{0}}\right) 
\exp\left (-\frac{\tau}{\tau_{0}}\right )
\left(\tilde{\mathbf{v}} -\frac{a \tilde{\mathbf{x}} + b \tilde{\mathbf{v}}}{d} \right),
\end{align}
where
\begin{align}
a &= \tilde{\mathbf{v}} \cdot \tilde{\mathbf{v}} \\
b &= -\tilde{\mathbf{x}} \cdot \tilde{\mathbf{v}} \\
c &= \tilde{\mathbf{x}} \cdot \tilde{\mathbf{x}} - \tilde{r}^{2} \\
d &= \sqrt{b^{2} - a c}, \quad b^{2} - a c > 0 \\
\tau &= \frac{b - d}{a} > 0.
\end{align}


\subsubsection{Contact force}
Physical contact force
\begin{align}
\mathbf{f}^{c} &= - h \cdot \left(\mu \cdot \hat{\mathbf{n}} - \kappa \cdot (\mathbf{v} \cdot \hat{\mathbf{t}}) \hat{\mathbf{t}}\right), \quad h < 0
\end{align}


\subsubsection{Random Fluctuation}
Uniformly distributed random fluctuation force
\begin{align}
\boldsymbol{\xi} &= f \cdot \begin{bmatrix} \cos(\varphi) & \sin(\varphi) \end{bmatrix},
\end{align}
where
\begin{align}
f \in [0, f_{max}],\quad \varphi \in [0, 2 \pi]
\end{align}


\subsection{Rotational}
% FDS evac manual pages: 20 - 21
Total torque exerted on agent $ M(t) $, is the sum of contact, social and motivational torques
\begin{align}
M_{i}(t) = M_{i}^{adj} + \sum_{j\neq i}^{} \left(M_{ij}^{soc} + M_{ij}^{c}\right) + \sum_{w}^{} \left(M_{iw}^{soc} + M_{iw}^{c}\right) + \eta_{i}(t)
\end{align}


\subsubsection{Adjusting torque}
\begin{align}
M_{i}^{adj} &= \frac{I_{i}}{\tau_{i}} \left((\varphi_{i}(t) - \varphi_{i}^{0}) \omega^{0} - \omega(t)\right) \\
\end{align}

\subsubsection{Social torque}
\begin{align}
\mathbf{M}_{i}^{soc} = \mathbf{r}_{i}^{soc} \times \mathbf{f}_{ij}^{soc}
\end{align}

\subsubsection{Contact torque}
\begin{align}
\mathbf{M}_{i}^{c} = \mathbf{r}_{i}^{c} \times \mathbf{f}_{ij}^{c}
\end{align}

\subsubsection{Related equations}
Torque calculated using cross product
\begin{align}
\mathbf{M} = \mathbf{r} \times \mathbf{f} =  \begin{vmatrix} \mathbf{i} & \mathbf{j} & \mathbf{k} \\ R_{1} & R_{2} & R_{3} \\ f_{1} & f_{2} & f_{3} \\ \end{vmatrix} 
\end{align}
which in two dimensions is
\begin{align}
M = \begin{vmatrix} R_{1} & R_{2} \\ f_{1} & f_{2} \\ \end{vmatrix} = R_{1} \cdot f_{2} - R_{2} \cdot f_{1}
\end{align}
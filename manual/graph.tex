\documentclass[tikz]{article}
%\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

\usepackage{geometry}
\geometry{hmargin=1cm,vmargin=1cm}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathtools}

%\usepackage{graphics}

\usepackage{tikz}
\usetikzlibrary{calc}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}

%%%<
\usepackage{verbatim}
\usepackage[active,tightpage]{preview}
\PreviewEnvironment{tikzpicture}
\setlength{\PreviewBorder}{10pt}%
%%%>

% Input paths
\makeatletter
\def\input@path{{figures/}}
\makeatother

% Dimensions
% Ratio of a4paper 210 x 297 mm
\def\width{29.7}
\def\height{21.0}


\tikzset{
    x=1cm, 
    y=1cm,
    largenode/.style={rectangle,rounded corners,draw=black, top color=white, bottom color=white!50, inner sep=1em, minimum size=3em, text centered},
    smallnode/.style={rectangle,rounded corners,draw=black, top color=white, bottom color=white!50, inner sep=0.5em, minimum size=1em, text centered},
    inactive/.style={rectangle,rounded corners,draw=black, top color=white, bottom color=white!50, inner sep=1em, minimum size=3em, text centered, opacity=0.5},
    simuarrow/.style={-stealth, thick},
}

%http://tex.stackexchange.com/questions/69439/how-can-i-achieve-relative-positioning-in-tikz
%http://tex.stackexchange.com/questions/160918/circular-graph-with-many-nodes
%http://tex.stackexchange.com/questions/172819/how-to-connect-relative-polar-coordinates-in-tikz

\begin{document}
\begin{tikzpicture}
% Origin centered grid
% ------------------------------------------------------------------------------
\pgfmathsetmacro{\xoffset}{\width / 2}
\pgfmathsetmacro{\yoffset}{\height / 2}

\coordinate[] (origin) at (0, 0);

\draw[step=1cm, line width=0.1mm, black!10!white] 
($ (origin) - (\xoffset, {\yoffset - 4}) $) grid ($ (origin) + (\xoffset, {\yoffset + 4}) $);


\draw[dotted] (0:3.0) arc (0:180:3.0);
\draw[dotted] (0:5.5) arc (0:180:5.5);
\draw[dotted] (0:8.5) arc (0:180:8.5);
\draw[dotted] (0:12.5) arc (0:180:12.5);


% ------------------------------------------------------------------------------
% Struct
% ------------------------------------------------------------------------------
\node[circle, minimum size=1em, draw=black] (struct) at (origin) {};

\def\N{4}:
\def\r{2.0};

\node[smallnode] (wall)     at ({-180/\N*0-180:2.5}) {Wall};
\node[smallnode] (agent)    at ({-180/\N*1-165:1.5}) {Agent};
\node[smallnode] (constant) at ({-180/\N*2-180:1.5}) {Constant};
\node[smallnode] (goal)     at ({-180/\N*3-195:1.5}) {Goal};
\node[smallnode] (result)   at ({-180/\N*4-180:2.5}) {Result};


%\path[->] (result)   edge[] (struct);
%\path[->] (wall)     edge[] (struct);
%\path[->] (agent)    edge[] (struct);
%\path[->] (goal)     edge[] (struct);
%\path[->] (constant) edge[] (struct);

% ------------------------------------------------------------------------------
% Parameters
% ------------------------------------------------------------------------------

\node[smallnode] (parameters) at ({-90:\r}) {Parameters};

\path[->] (parameters) edge[bend left] (result);
\path[->] (parameters) edge[bend left=10] (goal);
\path[->] (parameters) edge[] (constant);
\path[->] (parameters) edge[bend right=10] (agent);
\path[->] (parameters) edge[bend right] (wall);

% ------------------------------------------------------------------------------
% Simulation
% ------------------------------------------------------------------------------
\def\N{6};
\def\r{5.5};

\node[inactive] (navigation) at ({-180/\N*0-180:\r}) {Navigation};
\node[inactive] (game)       at ({-180/\N*1-180:\r}) {Game};
\node[largenode] (integrator)   at ({-180/\N*2-180:\r}) {Integrator};
\node[largenode] (goals)        at ({-180/\N*3-180:\r}) {Goals};
\node[largenode] (save)         at ({-180/\N*4-180:\r}) {Save};
\node[largenode] (print)        at ({-180/\N*5-180:\r}) {Print};
\node[largenode] (visualize)    at ({-180/\N*6-180:\r}) {Visualize};


\path[simuarrow] (navigation) edge[bend left=10] (game);
\path[simuarrow] (game)       edge[bend left=10] (integrator);
\path[simuarrow] (integrator) edge[bend left=10] (goals);
\path[simuarrow] (goals)      edge[bend left=10] (save);
\path[simuarrow] (save)       edge[bend left=10] (print);
\path[simuarrow] (print)      edge[bend left=10] (visualize);


\path[<->, dashed] (navigation) edge[] (agent);
\path[<->, dashed] (navigation) edge[] (wall);

\path[<->, dashed] (game)       edge[] (agent);

\path[<->, dashed] (integrator) edge[] (agent);
\path[<->, dashed] (integrator) edge[] (wall);
\path[<->, dashed] (integrator) edge[] (constant);

\path[<->, dashed] (goals)      edge[] (goal);
\path[<->, dashed] (goals)      edge[] (agent);


%\path[->, dashed] (struct) edge[] (save);
%\path[->, dashed] (struct) edge[] (print);
%\path[->, dashed] (struct) edge[] (visualize);


% ------------------------------------------------------------------------------
% Goals
% ------------------------------------------------------------------------------

\node[inactive, above=1.0 of goals] (goalhandler) {If goal reached $ \rightarrow $ Update agent and goal};

\path[->] (goalhandler) edge[] (goals);

% ------------------------------------------------------------------------------
% Core / Integrator
% ------------------------------------------------------------------------------

\node[largenode] (motion) at ($ (integrator) + (135:3) $) {Motion};

\node[largenode] (adjust) at ($ (motion) + (90:4) $) {Adjust};
\node[largenode] (agent-agent) at ($ (motion) + (135:4) $) {Agent-Agent};
\node[largenode] (agent-wall) at ($ (motion) + (155:4) $) {Agent-Wall};
\node[largenode] (random) at ($ (motion) + (180:4) $) {Random};

\path[->] (motion) edge[] (integrator);

\path[->] (adjust) edge[] (motion);
\path[->] (agent-agent) edge[] (motion);
\path[->] (agent-wall) edge[] (motion);
\path[->] (random) edge[] (motion);

% ------------------------------------------------------------------------------
% Game
% ------------------------------------------------------------------------------

\node[inactive, above left=1.0 of game] (strategy) {Strategy};

\path[->] (strategy) edge[] (game);

% ------------------------------------------------------------------------------
% Navigation
% ------------------------------------------------------------------------------

\node[inactive, left=1.0 of navigation] (astar) {Potential Field or $ A^{*} $};

\path[->] (astar) edge[] (navigation);


% ------------------------------------------------------------------------------
% Save
% ------------------------------------------------------------------------------

\node[largenode, above right=of save] (file) {HDF5 File};
\path[->, dashed] (save) edge[] (file);

% ------------------------------------------------------------------------------
% Analysis
% ------------------------------------------------------------------------------

\node[largenode, right=1.0 of visualize] (animation) {Animation};
%\node[largenode, below right=2.0 of file] (notebook) {Notebook};

\path[->, dashed] (visualize) edge[] (animation);
%\path[->, dashed] (visualize) edge[bend left] node[above, sloped] {FuncAnimation}  (animation);
%\path[->] (file) edge[] (notebook);

\end{tikzpicture}
\end{document}


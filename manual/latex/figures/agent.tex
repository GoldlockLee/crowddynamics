% FDS + EVAC page 19
% http://www.vtt.fi/inf/pdf/workingpapers/2009/W119.pdf

\def \radius {5};

% Centre (Origin)
\coordinate[] (centre) at (0, 0);

% Arc
\filldraw[opacity=0.2] (centre) -- ($ (centre) + (0.5, 0) $) arc (0:90:0.5) -- cycle;
\node[] () at ($ (centre) + (0.5, 0.5) $) {$ \varphi $};

\draw[->, opacity=0.8] ($ (centre) + (0.3, 0) $) arc (0:270:0.3) node[below] {$ \omega $};

%% Circle
\draw[fill=gray, opacity=0.2] (centre) circle (\radius);
\draw[dashed, ->] (centre) -- node[above] {$ r $} ($ (centre) + (-4, 3) $);

%% Ellipse
\pgfmathparse{0.59 * \radius}
\draw[black, fill=darkgray, opacity=0.2] (centre) ellipse (5 and 2.96);

\draw[dashed, ->] (centre) -- node[right] {$ r_{\text{t}} $} 
                  ($ (centre) + (0, \pgfmathresult) $);

%% Three circles
% Torso
\draw[fill=black, opacity=0.2] (centre) circle (\pgfmathresult);
% 
\pgfmathparse{0.37 * \radius}
\coordinate[] (centreLeft) at ($ (centre) - (\radius-\pgfmathresult, 0) $);
\coordinate[] (centreRigth) at ($ (centre) + (\radius-\pgfmathresult, 0) $);
% Shoulders
\draw[fill=black, opacity=0.2] (centreLeft)  circle (\pgfmathresult);
\draw[fill=black, opacity=0.2] (centreRigth) circle (\pgfmathresult);

\draw[dashed, ->] (centreLeft) -- node[above] {$ r_{\text{s}} $} ($ (centreLeft) - (\pgfmathresult, 0) $);
\draw[dashed, ->] (centreRigth) -- node[above] {$ r_{\text{s}} $} ($ (centreRigth) + (\pgfmathresult, 0) $);



% Axis
\draw[thick, ->] (centre) -- node[left] {$ \hat{\mathbf{n}} $} ($ (centre) + (0, 1) $);
\draw[thick, ->] (centre) -- node[below] {$ \hat{\mathbf{t}} $} ($ (centre) + (1, 0) $);

% Agent
\node[point] (agent) at (centre) {$ \mathbf{x} $};
\node[point] (shoulderLeft) at (centreLeft) {$ \mathbf{c}_{l} $};
\node[point] (shoulderRigth) at (centreRigth) {$ \mathbf{c}_{r} $};

\draw[dashed, ->] (agent) -- node[below] {$ r_{ts} $} (shoulderLeft);
%\draw[<->] (agent) -- node[below] {$ d $} (shoulderRigth);